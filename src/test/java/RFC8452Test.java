import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.Arguments;
import org.junit.jupiter.params.provider.MethodSource;

import java.util.stream.Stream;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.params.provider.Arguments.arguments;

public class RFC8452Test {

    @ParameterizedTest
    @MethodSource("rfc8452TestVectors")
    void shouldComplyToRFC8452(final String authenticationKey, final String input, final String expectedResult)
    {
        final String actualResult = new Polyval(authenticationKey).update(input).toString();
        assertEquals(expectedResult, actualResult);
    }

    static Stream<Arguments> rfc8452TestVectors() {
        return Stream.of(RFC8452_TEST_VECTORS);
    }

    static final Arguments[] RFC8452_TEST_VECTORS = new Arguments[] {

            // C.1.  AEAD_AES_128_GCM_SIV
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "00000000000000000000000000000000",
                    "00000000000000000000000000000000"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "00000000000000004000000000000000",
                    "eb93b7740962c5e49d2a90a7dc5cec74"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "00000000000000006000000000000000",
                    "48eb6c6c5a2dbe4a1dde508fee06361b"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "00000000000000008000000000000000",
                    "20806c26e3c1de019e111255708031d6"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "00000000000000000001000000000000",
                    "ce6edc9a50b36d9a98986bbf6a261c3b"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "00000000000000008001000000000000",
                    "81388746bc22d26b2abc3dcb15754222"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "04000000000000000000000000000000" +
                    "00000000000000000002000000000000",
                    "1e39b6d3344d348f6044f89935d1cf78"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "08000000000000004000000000000000",
                    "b26781e7e2c1376f96bec195f3709b2a"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "08000000000000006000000000000000",
                    "111f5affb18e4cc1164a01bdc12a4145"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "08000000000000008000000000000000",
                    "79745ab508622c8a958543675fac4688"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "08000000000000000001000000000000",
                    "2ce7daaf7c89490822051255b12eca6b"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "04000000000000000000000000000000" +
                    "08000000000000008001000000000000",
                    "9ca987715d69c1786711dfcd22f830fc"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "04000000000000000000000000000000" +
                    "05000000000000000000000000000000" +
                    "08000000000000000002000000000000",
                    "ffcd05d5770f34ad9267f0a59994b15a"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "60000000000000002000000000000000",
                    "f6ce9d3dcd68a2fd603c7ecc18fb9918"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "04000000000000000000000000000000" +
                    "9000000000000000a000000000000000",
                    "4781d492cb8f926c504caa36f61008fe"
            ),
            arguments(
                    "d9b360279694941ac5dbc6987ada7377",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "04000000000000000000000000000000" +
                    "a0000000000000009000000000000000",
                    "75cbc23a1a10e348aeb8e384b5cc79fd"
            ),
            arguments(
                    "036ee1fe2d7926af68898095e54e7b3c",
                    "00000000000000000000000000000000",
                    "00000000000000000000000000000000"
            ),
            arguments(
                    "3e28de1120b2981a0155795ca2812af6",
                    "46bb91c3c50000000000000000000000" +
                    "7a806c00000000000000000000000000" +
                    "28000000000000001800000000000000",
                    "43d9a745511dcfa21b96dd606f1d5720"
            ),
            arguments(
                    "43b8de9cea62330d15cccfc84a33e8c8",
                    "fc880c94a95198874296000000000000" +
                    "bdc66f14654500000000000000000000" +
                    "50000000000000003000000000000000",
                    "26498e0d2b1ef004e808c458e8f2f515"
            ),
            arguments(
                    "8a51df64d93eaf667c2c09bd454ce5c5",
                    "046787f3ea22c127aaf195d189472800" +
                    "1177441f195495860f00000000000000" +
                    "78000000000000004800000000000000" +
                            "",
                    "63a3451c0b23345ad02bba59956517cf"
            ),
            arguments(
                    "22f50707a95dd416df069d670cb775e8",
                    "c9882e5386fd9f92ec489c8fde2be2cf" +
                    "97e74e93000000000000000000000000" +
                    "9f572c614b4745914474e7c700000000" +
                    "a0000000000000006000000000000000",
                    "0cca0423fba9d77fe7e2e6963b08cdd0"
            ),
            arguments(
                    "0b00a29a83e7e95b92e3a0783b29f140",
                    "2950a70d5a1db2316fd568378da107b5" +
                    "2b0da55210cc1c1b0a00000000000000" +
                    "0d8c8451178082355c9e940fea2f5800" +
                    "c8000000000000007800000000000000",
                    "1086ef25247aa41009bbc40871d9b350"
            ),
            arguments(
                    "21c874a8bad3603d1c3e8784df5b3f9f",
                    "1860f762ebfbd08284e421702de0de18" +
                    "baa9c9596291b08466f37de21c7f0000" +
                    "6b3db4da3d57aa94842b9803a96e07fb" +
                    "6de70000000000000000000000000000" +
                    "f0000000000000009000000000000000",
                    "55462a5afa0da8d646481e049ef9c764"
            ),
            arguments(
                    "3724f55f1d22ac0ab830da0b6a995d74",
                    "7576f7028ec6eb5ea7e298342a94d4b2" +
                    "02b370ef9768ec6561c4fe6b7e7296fa" +
                    "859c2100000000000000000000000000" +
                    "e42a3c02c25b64869e146d7b233987bd" +
                    "dfc240871d0000000000000000000000" +
                    "1801000000000000a800000000000000",
                    "4cbba090f03f7d1188ea55749fa6c7bd"
            ),

            // C.2.  AEAD_AES_256_GCM_SIV
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "00000000000000000000000000000000",
                    "00000000000000000000000000000000"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "00000000000000004000000000000000",
                    "05230f62f0eac8aa14fe4d646b59cd41"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "00000000000000006000000000000000",
                    "6d81a24732fd6d03ae5af544720a1c13"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "00000000000000008000000000000000",
                    "74eee2bf7c9a165f8b25dea73db32a6d"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "00000000000000000001000000000000",
                    "899b6381b3d46f0def7aa0517ba188f5"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "00000000000000008001000000000000",
                    "c1f8593d8fc29b0c290cae1992f71f51"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "04000000000000000000000000000000" +
                    "00000000000000000002000000000000",
                    "6ef38b06046c7c0e225efaef8e2ec4c4"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "08000000000000004000000000000000",
                    "34e57bafe011b9b36fc6821b7ffb3354"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "08000000000000006000000000000000",
                    "5c47d68a22061c1ad5623a3b66a8e206"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "08000000000000008000000000000000",
                    "452896726c616746f01d11d82911d478"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "08000000000000000001000000000000",
                    "4e58c1e341c9bb0ae34eda9509dfc90c"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "04000000000000000000000000000000" +
                    "08000000000000008001000000000000",
                    "2566a4aff9a525df9772c16d4eaf8d2a"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "04000000000000000000000000000000" +
                    "05000000000000000000000000000000" +
                    "08000000000000000002000000000000",
                    "da58d2f61b0a9d343b2f37fb0c519733"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "60000000000000002000000000000000",
                    "6dc76ae84b88916e073a303aafde05cf"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "04000000000000000000000000000000" +
                    "9000000000000000a000000000000000",
                    "973ef4fd04bd31d193816ab26f8655ca"
            ),
            arguments(
                    "b5d3c529dfafac43136d2d11be284d7f",
                    "01000000000000000000000000000000" +
                    "02000000000000000000000000000000" +
                    "03000000000000000000000000000000" +
                    "04000000000000000000000000000000" +
                    "a0000000000000009000000000000000",
                    "2cbb6b7ab2dbffefb797f825f826870c"
            ),
            arguments(
                    "e40d26f82774aa27f47b047b608b9585",
                    "00000000000000000000000000000000",
                    "00000000000000000000000000000000"
            ),
            arguments(
                    "b546f5a850d0a90adfe39e95c2510fc6",
                    "4fbdc66f140000000000000000000000" +
                    "671fdd00000000000000000000000000" +
                    "28000000000000001800000000000000",
                    "b91f91f96b159a7c611c05035b839e92"
            ),
            arguments(
                    "e156e1f9b0b07b780cbe30f259e3c8da",
                    "6787f3ea22c127aaf195000000000000" +
                    "195495860f0400000000000000000000" +
                    "50000000000000003000000000000000",
                    "2c480ed9d236b1df24c6eec109bd40c1"
            ),
            arguments(
                    "0533fd71f4119257361a3ff1469dd4e5",
                    "489c8fde2be2cf97e74e932d4ed87d00" +
                    "c9882e5386fd9f92ec00000000000000" +
                    "78000000000000004800000000000000",
                    "bf160bc9ded8c63057d2c38aae552fb4"
            ),
            arguments(
                    "64779ab10ee8a280272f14cc8851b727",
                    "0da55210cc1c1b0abde3b2f204d1e9f8" +
                    "b06bc47f000000000000000000000000" +
                    "1db2316fd568378da107b52b00000000" +
                    "a0000000000000006000000000000000",
                    "cc86ee22c861e1fd474c84676b42739c"
            ),
            arguments(
                    "27c2959ed4daea3b1f52e849478de376",
                    "f37de21c7ff901cfe8a69615a93fdf7a" +
                    "98cad481796245709f00000000000000" +
                    "21702de0de18baa9c9596291b0846600" +
                    "c8000000000000007800000000000000",
                    "c4fa5e5b713853703bcf8e6424505fa5"
            ),
            arguments(
                    "670b98154076ddb59b7a9137d0dcc0f0",
                    "9c2159058b1f0fe91433a5bdc20e214e" +
                    "ab7fecef4454a10ef0657df21ac70000" +
                    "b202b370ef9768ec6561c4fe6b7e7296" +
                    "fa850000000000000000000000000000" +
                    "f0000000000000009000000000000000",
                    "4e4108f09f41d797dc9256f8da8d58c7"
            ),
            arguments(
                    "cb8c3aa3f8dbaeb4b28a3e86ff6625f8",
                    "734320ccc9d9bbbb19cb81b2af4ecbc3" +
                    "e72834321f7aa0f70b7282b4f33df23f" +
                    "16754100000000000000000000000000" +
                    "ced532ce4159b035277d4dfbb7db6296" +
                    "8b13cd4eec0000000000000000000000" +
                    "1801000000000000a800000000000000",
                    "ffd503c7dd712eb3791b7114b17bb0cf"
            ),

            // C.3.  Counter Wrap Tests
            arguments(
                    "dc95c078a24089895275f3d86b4fb868",
                    "00000000000000000000000000000000" +
                    "4db923dc793ee6497c76dcc03a98e108" +
                    "00000000000000000001000000000000",
                    "7367cdb411b730128dd56e8edc0eff56"
            ),
            arguments(
                    "dc95c078a24089895275f3d86b4fb868",
                    "eb3640277c7ffd1303c7a542d02d3e4c" +
                    "00000000000000000000000000000000" +
                    "0000000000000000c000000000000000",
                    "7367cdb411b730128dd56e8edc0eff56"
            ),
    };

}